:root{--purple:#8A6CF6;--border:#E5E7EB;--muted:#6B7280;--text:#111827}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:#fff;width:100vw;height:100vh;height:100svh;height:-webkit-fill-available;height:100dvh;overflow:hidden;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Ubuntu,"Helvetica Neue",Arial,"Noto Sans",sans-serif;color:var(--text)}
.app{width:100vw;height:100vh;height:100svh;height:-webkit-fill-available;height:100dvh;background:#fff;border-radius:0;overflow:hidden;box-shadow:none;display:flex;flex-direction:column;overscroll-behavior:contain}
.topbar{background:var(--purple);color:#fff;display:flex;align-items:center;justify-content:center;gap:12px;padding:0 16px;font-weight:600;min-height:48px;padding-top:env(safe-area-inset-top,0px)}
.topbar .swap-btn{background:transparent;border:0;padding:0;width:28px;height:28px;display:flex;align-items:center;justify-content:center;cursor:pointer}
.topbar .swap-btn img{width:24px;height:24px}
.content{padding:16px;background:#fff;flex:1;overflow:auto}
.card{border:1px solid var(--border);border-radius:10px;margin-bottom:16px}
textarea{width:100%;height:clamp(100px,25vh,180px);border:0;outline:0;resize:none;padding:12px;font-size:14px;color:var(--text);background:transparent}
textarea::placeholder{color:var(--muted)}
.bottombar{position:relative;background:#efefef;display:flex;align-items:flex-end;justify-content:space-between;padding:14px 20px 10px;height:80px;padding-bottom:calc(10px + env(safe-area-inset-bottom,0px))}
.nav-item{background:none;border:0;display:flex;flex-direction:column;align-items:center;gap:6px;color:#3f3f46;font-size:12px;cursor:pointer}
.nav-item img{width:24px;height:24px;object-fit:contain}
.center-slot{position:absolute;left:50%;transform:translateX(-50%);top:-28px;display:flex;flex-direction:column;align-items:center}
.avatar-btn{width:56px;height:56px;border-radius:50%;border:4px solid #fff;overflow:hidden;box-shadow:0 4px 12px rgba(0,0,0,.25);background:#ddd;padding:0;cursor:pointer}
.avatar-btn img{width:100%;height:100%;object-fit:cover}
.center-label{margin-top:6px;font-size:12px;color:#111827;white-space:nowrap}
.view{display:none}
.app.page-translate .view.translate{display:block}
.app.page-explain .view.explain{display:block}
.info-card{border:2px solid var(--purple);border-radius:10px;padding:12px;background:#fff;margin-bottom:16px}
.info-card .title{font-weight:700}
.info-card-header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:8px}
.explain-toggle{display:inline-flex;align-items:center;gap:6px;padding:6px 12px;border-radius:9999px;border:1px solid var(--border);background:#fff;color:#4b5563;font-weight:600;font-size:13px;cursor:pointer;transition:background .2s,border-color .2s,color .2s,transform .2s}
.explain-toggle:hover{background:#f3f4f6;border-color:#d1d5db;color:#111827}
.explain-toggle__icon{width:18px;height:18px;display:flex;align-items:center;justify-content:center;transition:transform .25s}
.explain-collapse{overflow:hidden;transition:max-height .35s ease,opacity .25s ease;opacity:0}
.explain-collapse--open{opacity:1}
.explain-collapse--open .explain-toggle__icon{transform:rotate(180deg)}
.explain-collapse__inner{padding-top:4px}
#explain-text{margin:0;white-space:normal;line-height:1.6}
.explain-plain{margin:0;white-space:pre-line}
.explain-sections{display:flex;flex-direction:column;gap:12px}
.explain-section{padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#f9fafb}
.explain-section__title{font-weight:700;margin:0 0 6px;text-transform:uppercase;font-size:12px;letter-spacing:.08em;color:#4338ca}
.explain-section__body{margin:0;font-size:14px;color:#111827}
.explain-section--idiom{border-color:#fde047;background:#fff7d6;box-shadow:inset 0 0 0 1px #facc15}
.explain-section--idiom .explain-section__title{color:#92400e}
.card.example{background:#f9fafb;padding:12px}
.app.page-translate .nav-item--translate,
.app.page-explain .nav-item--explain{color:#111827;font-weight:600}
[hidden]{display:none !important}
.input-card{position:relative;background:#f9fafb;padding:12px}
.input-area{width:100%;min-height:56px;border:0;outline:0;background:transparent;font-size:14px;color:var(--text);resize:none}
.send-btn{position:absolute;right:12px;bottom:12px;width:44px;height:44px;border-radius:9999px;border:0;background:var(--purple);color:#fff;font-size:18px;display:flex;align-items:center;justify-content:center;cursor:pointer}
.tokenized-wrapper{display:flex;flex-direction:column;gap:12px}
.tokenized{min-height:56px;display:flex;flex-wrap:wrap;gap:6px 8px}
.tokenized .word{border:0;background:transparent;padding:0;margin:0;font:inherit;color:inherit;text-align:left;text-decoration-line:underline;text-decoration-style:dotted;text-decoration-color:#9ca3af;text-underline-offset:4px;line-height:1.4;word-break:break-word;cursor:pointer}
.lang-picker{position:relative}
.lang-btn{background:transparent;border:0;color:#fff;font-weight:700;padding:6px 8px;border-radius:6px;cursor:pointer}
.lang-btn:focus-visible{outline:2px solid #fff;outline-offset:2px}
.dropdown{position:absolute;top:calc(100% + 8px);left:50%;transform:translateX(-50%);background:#fff;color:#111827;border:1px solid var(--border);border-radius:10px;box-shadow:0 12px 24px rgba(0,0,0,.2);z-index:20;min-width:160px;overflow:hidden}
.dropdown .item{display:block;width:100%;text-align:left;background:#fff;border:0;padding:10px 12px;font-size:14px;color:#111827;cursor:pointer}
.dropdown .item:hover{background:#f3f4f6}
.dropdown .item.active{background:#eef2ff;font-weight:700}
.title-only{font-weight:700}
.word-hero{font-size:32px;font-weight:800;display:inline-block;position:relative;padding-bottom:8px;margin:12px 16px}
.word-hero::after{content:"";position:absolute;left:0;right:0;bottom:0;height:3px;background:#111827;border-radius:3px}
.word-list.card{background:#fff}
.tokenized .word{cursor:pointer}
.topbar.left{justify-content:flex-start;gap:8px;padding-left:12px}
.back-btn{background:transparent;border:0;color:#fff;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:6px;cursor:pointer;font-size:18px}
.back-btn:active{opacity:.8}
.secondary-btn{align-self:flex-start;border:1px solid var(--border);background:#fff;border-radius:9999px;padding:6px 16px;font-size:12px;font-weight:600;color:var(--muted);cursor:pointer;transition:background .2s,border-color .2s,color .2s}
.secondary-btn:hover{background:#f3f4f6;border-color:#d1d5db;color:#111827}

.analysis-card{padding:16px;margin-bottom:16px;border:1px solid var(--border);border-radius:10px;background:#fff}
.analysis-card--error{border-color:#fca5a5;background:#fef2f2}
.loading-card{display:flex;flex-direction:column;align-items:center;gap:12px;text-align:center}
.spinner{width:32px;height:32px;border:3px solid #e5e7eb;border-top-color:var(--purple);border-radius:9999px;animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.analysis-title{margin:0 0 12px;font-size:16px;font-weight:700}
.analysis-block{margin-bottom:12px}
.analysis-block:last-child{margin-bottom:0}
.analysis-meta{margin:0;font-size:14px;color:var(--muted)}
.analysis-status{margin:0;font-size:14px}
.analysis-definition{margin:0;display:grid;grid-template-columns:max-content 1fr;gap:8px 16px;font-size:14px}
.analysis-definition.two-columns{grid-template-columns:repeat(2,minmax(0,1fr))}
.analysis-definition.two-columns dt{font-weight:600}
.analysis-definition.two-columns dd{font-weight:500}
.analysis-definition dt{font-weight:600;white-space:nowrap}
.analysis-definition dd{margin:0}
.cases-list{margin:0;padding-left:18px}
.analysis-text-block{margin:0;font-size:14px;line-height:1.6}
.structure-explainer{margin-bottom:12px;font-size:13px;line-height:1.7;color:#4338ca}
.analysis-summary-text{margin:0;font-size:15px;line-height:1.6}
.analysis-pills{margin:12px 0 0;padding:0;list-style:none;display:flex;flex-wrap:wrap;gap:8px}
.analysis-pills li{background:#eef2ff;color:#3730a3;border-radius:9999px;padding:6px 12px;font-size:12px;font-weight:600}
.analysis-chip-groups{display:grid;gap:16px}
.analysis-chips{display:flex;flex-wrap:wrap;gap:8px}
.analysis-chip{background:#f4f4ff;color:#312e81;border-radius:16px;padding:6px 12px;font-size:13px;font-weight:600}
.analysis-chip.archaic{background:#fef2f2;color:#7f1d1d}
.analysis-subtitle{margin:0 0 8px;font-size:13px;font-weight:700;color:#4c1d95;text-transform:uppercase;letter-spacing:.08em}
.cases-table{width:100%;border-collapse:collapse;margin-top:12px;font-size:13px}
.cases-table th,.cases-table td{border:1px solid var(--border);padding:8px;text-align:left}
.cases-table thead{background:#f9fafb;font-weight:600}
.word-analysis{display:flex;flex-direction:column}
.word-summary{background:linear-gradient(135deg,#eef2ff,#f8fafc)}
.meaning-list{margin:0;padding-left:18px;display:flex;flex-direction:column;gap:12px}
.meaning-definition{margin:0 0 8px;font-weight:600}
.meaning-examples{margin:0;padding-left:18px;display:flex;flex-direction:column;gap:6px}
.meaning-notes{margin:8px 0 0;font-size:13px;color:var(--muted)}
.quiz-list{margin:0;padding-left:18px;display:flex;flex-direction:column;gap:12px}
.quiz-question{margin:0 0 8px;font-weight:600}
.quiz-options{margin:0;padding-left:18px;display:flex;flex-direction:column;gap:6px}
.quiz-options .correct{color:#15803d;font-weight:600}
.quiz-bullet{margin-right:6px}
.analysis-raw{margin:12px 0 0;background:#f9fafb;border-radius:8px;padding:12px;font-size:13px;white-space:pre-wrap;word-break:break-word}
.analysis-steps{background:linear-gradient(135deg,#fff7ed,#fefce8)}
.analysis-steps-list{margin:0 0 12px;padding-left:18px;display:flex;flex-direction:column;gap:8px;font-size:13px}
.analysis-steps-list strong{display:block;margin-bottom:4px;color:#7c2d12}
